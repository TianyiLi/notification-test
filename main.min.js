require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var a=e[n]=new t.Module;r[n][0].call(a.exports,i,a,a.exports)}return e[n].exports}function o(){this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({2:[function(require,module,exports) {
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.webstomp=t():e.webstomp=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unicodeStringToTypedArray=function(e){var t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}),n=Array.prototype.map.call(t,function(e){return e.charCodeAt(0)});return new Uint8Array(n)},t.typedArrayToUnicodeString=function(e){var t=String.fromCharCode.apply(String,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e)).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(t)},t.sizeOfUTF8=function(e){return e?encodeURIComponent(e).match(/%..|./g).length:0},t.createId=function(){var e=(new Date).getTime(),t=Math.floor(1e3*Math.random());return e+"-"+t};t.VERSIONS={V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"},supportedProtocols:function(){return["v10.stomp","v11.stomp","v12.stomp"]}},t.BYTES={LF:"\n",NULL:"\0"},t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=(r=o)&&r.__esModule?r:{default:r},u=n(0);var c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.binary,i=void 0!==r&&r,a=n.heartbeat,o=void 0===a?{outgoing:1e4,incoming:1e4}:a,s=n.debug,u=void 0===s||s;this.ws=t,this.ws.binaryType="arraybuffer",this.isBinary=!!i,this.hasDebug=!!u,this.connected=!1,this.heartbeat=o||{outgoing:0,incoming:0},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData=""}return a(e,[{key:"debug",value:function(){var e;this.hasDebug&&(e=console).log.apply(e,arguments)}},{key:"connect",value:function(){var e=this,t=this._parseConnect.apply(this,arguments),n=i(t,3),r=n[0],a=n[1],o=n[2];this.connectCallback=a,this.debug("Opening Web Socket..."),this.ws.onmessage=function(t){var n=t.data;if(t.data instanceof ArrayBuffer&&(n=(0,u.typedArrayToUnicodeString)(new Uint8Array(t.data))),e.serverActivity=Date.now(),n!==u.BYTES.LF){e.debug("<<< "+n);var r=s.default.unmarshall(e.partialData+n);e.partialData=r.partial,r.frames.forEach(function(t){switch(t.command){case"CONNECTED":e.debug("connected to server "+t.headers.server),e.connected=!0,e.version=t.headers.version,e._setupHeartbeat(t.headers),a&&a(t);break;case"MESSAGE":var n=t.headers.subscription,r=e.subscriptions[n]||e.onreceive;if(r){var i=e.version===u.VERSIONS.V1_2&&t.headers.ack||t.headers["message-id"];t.ack=e.ack.bind(e,i,n),t.nack=e.nack.bind(e,i,n),r(t)}else e.debug("Unhandled received MESSAGE: "+t);break;case"RECEIPT":e.onreceipt&&e.onreceipt(t);break;case"ERROR":o&&o(t);break;default:e.debug("Unhandled frame: "+t)}})}else e.debug("<<< PONG")},this.ws.onclose=function(t){e.debug("Whoops! Lost connection to "+e.ws.url+":",{event:t}),e._cleanUp(),o&&o(t)},this.ws.onopen=function(){e.debug("Web Socket Opened..."),r["accept-version"]=u.VERSIONS.supportedVersions(),r["heart-beat"]||(r["heart-beat"]=[e.heartbeat.outgoing,e.heartbeat.incoming].join(",")),e._transmit("CONNECT",r)}}},{key:"disconnect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),e&&e()}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);r.destination=e,this._transmit("SEND",r,t)}},{key:"begin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tx-"+(0,u.createId)();return this._transmit("BEGIN",{transaction:e}),{id:e,commit:this.commit.bind(this,e),abort:this.abort.bind(this,e)}}},{key:"commit",value:function(e){this._transmit("COMMIT",{transaction:e})}},{key:"abort",value:function(e){this._transmit("ABORT",{transaction:e})}},{key:"ack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);r[this.version===u.VERSIONS.V1_2?"id":"message-id"]=e,r.subscription=t,this._transmit("ACK",r)}},{key:"nack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);r[this.version===u.VERSIONS.V1_2?"id":"message-id"]=e,r.subscription=t,this._transmit("NACK",r)}},{key:"subscribe",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);return r.id||(r.id="sub-"+(0,u.createId)()),r.destination=e,this.subscriptions[r.id]=t,this._transmit("SUBSCRIBE",r),{id:r.id,unsubscribe:this.unsubscribe.bind(this,r.id)}}},{key:"unsubscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t);delete this.subscriptions[e],n.id=e,this._transmit("UNSUBSCRIBE",n)}},{key:"_cleanUp",value:function(){this.connected=!1,clearInterval(this.pinger),clearInterval(this.ponger)}},{key:"_transmit",value:function(e,t,n){var r=s.default.marshall(e,t,n);this.debug(">>> "+r,{frame:{command:e,headers:t,body:n}}),this._wsSend(r)}},{key:"_wsSend",value:function(e){for(this.isBinary&&(e=(0,u.unicodeStringToTypedArray)(e)),this.debug(">>> length "+e.length);;){if(!(e.length>this.maxWebSocketFrameSize))return this.ws.send(e);this.ws.send(e.slice(0,this.maxWebSocketFrameSize)),e=e.slice(this.maxWebSocketFrameSize),this.debug("remaining = "+e.length)}}},{key:"_setupHeartbeat",value:function(e){var t=this;if(this.version===u.VERSIONS.V1_1||this.version===u.VERSIONS.V1_2){var n=(e["heart-beat"]||"0,0").split(",").map(function(e){return parseInt(e,10)}),r=i(n,2),a=r[0],o=r[1];if(0!==this.heartbeat.outgoing&&0!==o){var s=Math.max(this.heartbeat.outgoing,o);this.debug("send PING every "+s+"ms"),this.pinger=setInterval(function(){t._wsSend(u.BYTES.LF),t.debug(">>> PING")},s)}if(0!==this.heartbeat.incoming&&0!==a){var c=Math.max(this.heartbeat.incoming,a);this.debug("check PONG every "+c+"ms"),this.ponger=setInterval(function(){var e=Date.now()-t.serverActivity;e>2*c&&(t.debug("did not receive server activity for the last "+e+"ms"),t.ws.close())},c)}}}},{key:"_parseConnect",value:function(){for(var e={},t=void 0,n=void 0,r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];switch(i.length){case 2:e=i[0],t=i[1];break;case 3:i[1]instanceof Function?(e=i[0],t=i[1],n=i[2]):(e.login=i[0],e.passcode=i[1],t=i[2]);break;case 4:e.login=i[0],e.passcode=i[1],t=i[2],n=i[3];break;default:e.login=i[0],e.passcode=i[1],t=i[2],n=i[3],e.host=i[4]}return[e,t,n]}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0);var a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.command=t,this.headers=n,this.body=r}return r(e,[{key:"toString",value:function(){var e=this,t=[this.command],n=!1===this.headers["content-length"];return n&&delete this.headers["content-length"],Object.keys(this.headers).forEach(function(n){var r=e.headers[n];t.push(n+":"+r)}),this.body&&!n&&t.push("content-length:"+(0,i.sizeOfUTF8)(this.body)),t.push(i.BYTES.LF+this.body),t.join(i.BYTES.LF)}}],[{key:"unmarshallSingle",value:function(t){var n=t.search(new RegExp(i.BYTES.LF+i.BYTES.LF)),r=t.substring(0,n).split(i.BYTES.LF),a=r.shift(),o={},s="",u=n+2,c=!0,l=!1,h=void 0;try{for(var d,f=r.reverse()[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var v=d.value,p=v.indexOf(":");o[(0,i.trim)(v.substring(0,p))]=(0,i.trim)(v.substring(p+1))}}catch(e){l=!0,h=e}finally{try{!c&&f.return&&f.return()}finally{if(l)throw h}}if(o["content-length"]){var b=parseInt(o["content-length"],10);s=(""+t).substring(u,u+b)}else for(var g=null,y=u;y<t.length&&(g=t.charAt(y))!==i.BYTES.NULL;y++)s+=g;return new e(a,o,s)}},{key:"unmarshall",value:function(t){var n=t.split(new RegExp(i.BYTES.NULL+i.BYTES.LF+"*")),r=n.slice(0,-1),a=n.slice(-1)[0],o={frames:r.map(function(t){return e.unmarshallSingle(t)}),partial:""};return a===i.BYTES.LF||-1!==a.search(RegExp(i.BYTES.NULL+i.BYTES.LF+"*$"))?o.frames.push(e.unmarshallSingle(a)):o.partial=a,o}},{key:"marshall",value:function(t,n,r){return new e(t,n,r).toString()+i.BYTES.NULL}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(1),a=(r=i)&&r.__esModule?r:{default:r},o=n(0);var s={VERSIONS:o.VERSIONS,client:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new WebSocket(e,t.protocols||o.VERSIONS.supportedProtocols());return new a.default(n,t)},over:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(a.default,[null].concat(t)))}};t.default=s,e.exports=t.default}])});
},{}],3:[function(require,module,exports) {
var global = (1,eval)("this");
var t=(0,eval)("this");!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).Push=e()}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){return o(e[s][1][t]||t)},f,f.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={errors:{incompatible:"PushError: Push.js is incompatible with browser.",invalid_plugin:"PushError: plugin class missing from plugin manifest (invalid plugin). Please check the documentation.",invalid_title:"PushError: title of notification must be a string",permission_denied:"PushError: permission request declined",sw_notification_error:"PushError: could not show a ServiceWorker notification due to the following reason: ",sw_registration_error:"PushError: could not register the ServiceWorker due to the following reason: ",unknown_interface:"PushError: unable to create notification: unknown interface"}}},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._win=e,this.GRANTED="granted",this.DEFAULT="default",this.DENIED="denied",this._permissions=[this.GRANTED,this.DEFAULT,this.DENIED]}return i(t,[{key:"request",value:function(t,e){return arguments.length>0?this._requestWithCallback.apply(this,arguments):this._requestAsPromise()}},{key:"_requestWithCallback",value:function(t,e){var n=this,i=this.get(),o=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n._win.Notification.permission;void 0===i&&n._win.webkitNotifications&&(i=n._win.webkitNotifications.checkPermission()),i===n.GRANTED||0===i?t&&t():e&&e()};i!==this.DEFAULT?o(i):this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._win.webkitNotifications.requestPermission(o):this._win.Notification&&this._win.Notification.requestPermission?this._win.Notification.requestPermission().then(o).catch(function(){e&&e()}):t&&t()}},{key:"_requestAsPromise",value:function(){var t=this,e=this.get(),n=e!==this.DEFAULT,i=this._win.Notification&&this._win.Notification.requestPermission,o=this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission;return new Promise(function(r,s){var a=function(e){return(n=e)===t.GRANTED||0===n?r():s();var n};n?a(e):o?t._win.webkitNotifications.requestPermission(function(t){a(t)}):i?t._win.Notification.requestPermission().then(function(t){a(t)}).catch(s):r()})}},{key:"has",value:function(){return this.get()===this.GRANTED}},{key:"get",value:function(){return this._win.Notification&&this._win.Notification.permission?this._win.Notification.permission:this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._permissions[this._win.webkitNotifications.checkPermission()]:navigator.mozNotification?this.GRANTED:this._win.external&&this._win.external.msIsSiteMode?this._win.external.msIsSiteMode()?this.GRANTED:this.DEFAULT:this.GRANTED}}]),t}();n.default=o},{}],3:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=i(t("./Messages")),s=i(t("./Permission")),a=i(t("./Util")),u=i(t("./agents/DesktopAgent")),c=i(t("./agents/MobileChromeAgent")),f=i(t("./agents/MobileFirefoxAgent")),l=i(t("./agents/MSAgent")),h=i(t("./agents/WebKitAgent")),d=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._currentId=0,this._notifications={},this._win=e,this.Permission=new s.default(e),this._agents={desktop:new u.default(e),chrome:new c.default(e),firefox:new f.default(e),ms:new l.default(e),webkit:new h.default(e)},this._configuration={serviceWorker:"/serviceWorker.min.js",fallback:function(t){}}}return o(t,[{key:"_closeNotification",value:function(t){var e=!0,n=this._notifications[t];if(void 0!==n){if(e=this._removeNotification(t),this._agents.desktop.isSupported())this._agents.desktop.close(n);else if(this._agents.webkit.isSupported())this._agents.webkit.close(n);else{if(!this._agents.ms.isSupported())throw e=!1,new Error(r.default.errors.unknown_interface);this._agents.ms.close()}return e}return!1}},{key:"_addNotification",value:function(t){var e=this._currentId;return this._notifications[e]=t,this._currentId++,e}},{key:"_removeNotification",value:function(t){var e=!1;return this._notifications.hasOwnProperty(t)&&(delete this._notifications[t],e=!0),e}},{key:"_prepareNotification",value:function(t,e){var n,i=this;return n={get:function(){return i._notifications[t]},close:function(){i._closeNotification(t)}},e.timeout&&setTimeout(function(){n.close()},e.timeout),n}},{key:"_serviceWorkerCallback",value:function(t,e,n){var i=this,o=this._addNotification(t[t.length-1]);navigator.serviceWorker.addEventListener("message",function(t){var e=JSON.parse(t.data);"close"===e.action&&Number.isInteger(e.id)&&i._removeNotification(e.id)}),n(this._prepareNotification(o,e))}},{key:"_createCallback",value:function(t,e,n){var i,o=this,r=null;if(e=e||{},i=function(t){o._removeNotification(t),a.default.isFunction(e.onClose)&&e.onClose.call(o,r)},this._agents.desktop.isSupported())try{r=this._agents.desktop.create(t,e)}catch(i){var s=this._currentId,u=this.config().serviceWorker;this._agents.chrome.isSupported()&&this._agents.chrome.create(s,t,e,u,function(t){return o._serviceWorkerCallback(t,e,n)})}else this._agents.webkit.isSupported()?r=this._agents.webkit.create(t,e):this._agents.firefox.isSupported()?this._agents.firefox.create(t,e):this._agents.ms.isSupported()?r=this._agents.ms.create(t,e):(e.title=t,this.config().fallback(e));if(null!==r){var c=this._addNotification(r),f=this._prepareNotification(c,e);a.default.isFunction(e.onShow)&&r.addEventListener("show",e.onShow),a.default.isFunction(e.onError)&&r.addEventListener("error",e.onError),a.default.isFunction(e.onClick)&&r.addEventListener("click",e.onClick),r.addEventListener("close",function(){i(c)}),r.addEventListener("cancel",function(){i(c)}),n(f)}n(null)}},{key:"create",value:function(t,e){var n,i=this;if(!a.default.isString(t))throw new Error(r.default.errors.invalid_title);return n=this.Permission.has()?function(n,o){try{i._createCallback(t,e,n)}catch(t){o(t)}}:function(n,o){i.Permission.request().then(function(){i._createCallback(t,e,n)}).catch(function(){o(r.default.errors.permission_denied)})},new Promise(n)}},{key:"count",value:function(){var t=void 0,e=0;for(t in this._notifications)this._notifications.hasOwnProperty(t)&&e++;return e}},{key:"close",value:function(t){var e=void 0;for(e in this._notifications)if(this._notifications.hasOwnProperty(e)&&this._notifications[e].tag===t)return this._closeNotification(e)}},{key:"clear",value:function(){var t=void 0,e=!0;for(t in this._notifications)this._notifications.hasOwnProperty(t)&&(e=e&&this._closeNotification(t));return e}},{key:"supported",value:function(){var t=!1;for(var e in this._agents)this._agents.hasOwnProperty(e)&&(t=t||this._agents[e].isSupported());return t}},{key:"config",value:function(t){return(void 0!==t||null!==t&&a.default.isObject(t))&&a.default.objectMerge(this._configuration,t),this._configuration}},{key:"extend",value:function(t){var e,n={}.hasOwnProperty;if(!n.call(t,"plugin"))throw new Error(r.default.errors.invalid_plugin);n.call(t,"config")&&a.default.isObject(t.config)&&null!==t.config&&this.config(t.config),e=new(0,t.plugin)(this.config());for(var i in e)n.call(e,i)&&a.default.isFunction(e[i])&&(this[i]=e[i])}}]),t}();n.default=d},{"./Messages":1,"./Permission":2,"./Util":4,"./agents/DesktopAgent":6,"./agents/MSAgent":7,"./agents/MobileChromeAgent":8,"./agents/MobileFirefoxAgent":9,"./agents/WebKitAgent":10}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return o(t,null,[{key:"isUndefined",value:function(t){return void 0===t}},{key:"isString",value:function(t){return"string"==typeof t}},{key:"isFunction",value:function(t){return t&&"[object Function]"==={}.toString.call(t)}},{key:"isObject",value:function(t){return"object"==(void 0===t?"undefined":i(t))}},{key:"objectMerge",value:function(t,e){for(var n in e)t.hasOwnProperty(n)&&this.isObject(t[n])&&this.isObject(e[n])?this.objectMerge(t[n],e[n]):t[n]=e[n]}}]),t}();n.default=r},{}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._win=e}},{}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=i(t("./AbstractAgent")),s=i(t("../Util")),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"isSupported",value:function(){return void 0!==this._win.Notification}},{key:"create",value:function(t,e){return new this._win.Notification(t,{icon:s.default.isString(e.icon)||s.default.isUndefined(e.icon)?e.icon:e.icon.x32,body:e.body,tag:e.tag,requireInteraction:e.requireInteraction})}},{key:"close",value:function(t){t.close()}}]),e}();n.default=a},{"../Util":4,"./AbstractAgent":5}],7:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=i(t("./AbstractAgent")),s=i(t("../Util")),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"isSupported",value:function(){return void 0!==this._win.external&&void 0!==this._win.external.msIsSiteMode}},{key:"create",value:function(t,e){return this._win.external.msSiteModeClearIconOverlay(),this._win.external.msSiteModeSetIconOverlay(s.default.isString(e.icon)||s.default.isUndefined(e.icon)?e.icon:e.icon.x16,t),this._win.external.msSiteModeActivate(),null}},{key:"close",value:function(){this._win.external.msSiteModeClearIconOverlay()}}]),e}();n.default=a},{"../Util":4,"./AbstractAgent":5}],8:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=i(t("./AbstractAgent")),s=i(t("../Util")),a=i(t("../Messages")),u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"isSupported",value:function(){return void 0!==this._win.navigator&&void 0!==this._win.navigator.serviceWorker}},{key:"getFunctionBody",value:function(t){return t.toString().match(/function[^{]+{([\s\S]*)}$/)[1]}},{key:"create",value:function(t,e,n,i,o){var r=this;this._win.navigator.serviceWorker.register(i),this._win.navigator.serviceWorker.ready.then(function(i){var u={id:t,link:n.link,origin:document.location.href,onClick:s.default.isFunction(n.onClick)?r.getFunctionBody(n.onClick):"",onClose:s.default.isFunction(n.onClose)?r.getFunctionBody(n.onClose):""};void 0!==n.data&&null!==n.data&&(u=Object.assign(u,n.data)),i.showNotification(e,{icon:n.icon,body:n.body,vibrate:n.vibrate,tag:n.tag,data:u,requireInteraction:n.requireInteraction,silent:n.silent}).then(function(){i.getNotifications().then(function(t){i.active.postMessage(""),o(t)})}).catch(function(t){throw new Error(a.default.errors.sw_notification_error+t.message)})}).catch(function(t){throw new Error(a.default.errors.sw_registration_error+t.message)})}},{key:"close",value:function(){}}]),e}();n.default=u},{"../Messages":1,"../Util":4,"./AbstractAgent":5}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(i=t("./AbstractAgent"))&&i.__esModule?i:{default:i},s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"isSupported",value:function(){return void 0!==this._win.navigator.mozNotification}},{key:"create",value:function(t,e){var n=this._win.navigator.mozNotification.createNotification(t,e.body,e.icon);return n.show(),n}}]),e}();n.default=s},{"./AbstractAgent":5}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(i=t("./AbstractAgent"))&&i.__esModule?i:{default:i},s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"isSupported",value:function(){return void 0!==this._win.webkitNotifications}},{key:"create",value:function(t,e){var n=this._win.webkitNotifications.createNotification(e.icon,t,e.body);return n.show(),n}},{key:"close",value:function(t){t.cancel()}}]),e}();n.default=s},{"./AbstractAgent":5}],11:[function(t,e,n){"use strict";var i,o=(i=t("./classes/Push"))&&i.__esModule?i:{default:i};e.exports=new o.default("undefined"!=typeof window?window:void 0)},{"./classes/Push":3}]},{},[11])(11)});
},{}],1:[function(require,module,exports) {
"use strict";var e=require("webstomp-client"),t=i(e),r=require("push.js"),n=i(r);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return{show(){e.style.display="block"},hide(){e.style.display="none"}}}function c(e){let t=[];for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];let r=e&&e.arg&&"mid"in e.arg?e.arg.mid:void 0;return void 0!==r&&r in d?d[r]:e instanceof Object&&"arg"in e&&"msg"in e.arg?e.arg.msg:t.length>0?t[0]||t[1]||`Cannot find corresponding element with ${r}`:void 0===r?"Argument undefined":`Cannot find corresponding element with ${r}`}document.body.onload=function(){let e=document.querySelector("#ip"),r=document.querySelector(".preset"),i=document.querySelector(".on-test"),c=document.querySelector("#ip-input"),d=document.querySelector("#test-drop"),o=document.querySelector("#test-drop-input"),p=document.querySelector("#test"),l=void 0;e.addEventListener("click",function(){let e=c.value;(l=t.default.client(`ws://${e}:61614/stomp`)).connect("user","password",()=>{l.subscribe("/topic/app",e=>{if(!e.body)return;let t=JSON.parse(e.body);"dispense/after_failed"===t.e&&n.default.create("出貨失敗",{body:`${s(t,"出貨失敗").text} 於 ${(new Date).toLocaleString()}`})}),a(r).hide(),a(i).show()},e=>{a(r).show(),a(i).hide(),alert(e)})}),p.addEventListener("click",function(){n.default.create("這是測試")}),d.addEventListener("click",function(){let e=o.value;/\d/g.test(e)&&fetch(`http://${c.value}/app/rest/drop.php?pid=${e}`).then(e=>e.json()).then(e=>{n.default.create("發送成功")})})};const d={cash_not_enough:"[!:-1]零錢不足，請改用其他方式交易",auth_failed:"[!:5]認證失敗",bill_phno:"[:-1]電信帳單支付 電話號碼:",create_order_failed:"[!:5]無法生成交易記錄",dispense_failed:"[!:5]出貨失敗。\n請洽詢服務台人員或撥打螢幕下方之統一速邁客服電話。\nFailed. Please contact station staff.","dispense-success":"[:5]出貨成功 請取出商品","dispense-success-receipt":"[:5]出貨成功 請取出商品及收據",dispense_ok:"[:5]出貨成功","easycard-success-change":"[:-1]卡片餘額: ","easycard-success-info":"[:-1]交易金額: ",get_invoice_id_failed:"[!:5]無法取得發票號碼",inbalance:"[!:5]餘額不足",inq_prod_failed:"[!:5]查詢商品資訊失敗","invoice-topic":"[:5]感謝您的使用",invoice_printed:"[:5]發票、收據列印完成\nReceipt is printed.",invoice_printing:"[:-1]發票、收據列印中",no_avail_chan:"[!:5]找不到可出貨的貨道",on_refund:"[:-1]出貨失敗，將進行退款動作","payment-no-cash":"[:-1]本商品目前不接受現金，請點選悠遊卡支付\nElectronic payment only, please select easycard.","payment-phone-pay-info":"[:-1]請開啟$var手機APP，將產出的支付QRcode對準QRcode掃描區。","payment-phone-pay-title":"[:-1]請開啟$var手機APP，將產出的支付QRcode對準QRcode掃描區","payment-with-cash":"[:-1]請直接投入現金，或點選下列支付方式\nPlease pay by cash, or select other payments below.",payment_timeout:"[!:5]等待支付結果逾時",payment_wait_creditcard:"[:-1]請將卡片貼近至感應區(或刷卡、插卡)",payment_wait_easycardedc:"[:-1]請將卡片輕觸讀卡機，\n10 秒內感應失敗將回到主畫面。\nHold your card near the reader.",payment_wait_easycard:"[:-1]請將卡片輕觸讀卡機，\n10 秒內感應失敗將回到主畫面。\nHold your card near the reader.",payment_wait_ipass:"[:-1]請將卡片輕觸讀卡機，\n10 秒內感應失敗將回到主畫面\nHold your card near the reader.",payment_wait_happycash:"[:-1]請將卡片靠上讀卡機",printer_disabled:"[!:5]印表機失效",printer_no_paper:"[!:12]目前印表機無紙，無法使用悠遊卡交易，請選再次點選商品使用投幣、紙鈔功能，謝謝",processing:"[:-1]處理中 請稍後",prod_oos:"[!:5]商品已售完","product-board-dispensing":"[:-1]出貨中 請稍候\nPlease wait.",q_input_unino:"[:15]是否輸入統一編號",q_print_receipt:"[:-1]是否列印收據","receipt-print-check":"[:-1]是否需要列印交易明細 ?","receipt-print-done":"[:5]請取出發票",receipt_printed:"[:5]發票、收據列印完成",failed_to_print_receipt:"[!:5]明細列印失敗",receipt_printing:"[:-1]發票、收據列印中",refunded_failed:"[!:5]退款失敗",refunded_success:"[:5]退款成功",undeterm_chid:"[!:5]無法決定貨道代號",undeterm_invoice_title:"[!:5]無法決定發票標題",undeterm_order:"[!:5]無法得知點菜記錄",undeterm_payment:"[!:5]無法得知支付記錄",undeterm_qrtype:"[!:5]無法辨別QRCode型態",undeterm_si:"[!:5]無法決定SI名稱",unknown_actype:"[!:5]未知的QRCode型類",easycardedc_failed:"[!:5]$var",happycash_refund:"[:-1]請將happycash貼近下方讀卡機完成退款動作",happycash_refund_failed_retry:"[:-1]退款失敗，請再次將happycash貼近下方讀卡機完成退款動作",happycash_refund_failed_final:"[!:5]退款失敗，請持列印憑證前往門市辦理退款",happycash_refunded:"[:5]退款成功",creditcard_error:"[!:5]信用卡支付錯誤 錯誤代號0001",creditcard_callbank:"[!:5]信用卡支付錯誤 錯誤代號0002",creditcard_timeout:"[!:5]信用卡支付錯誤 錯誤代號0003",creditcard_process_error:"[!:5]信用卡支付錯誤 錯誤代號0004",creditcard_communication_error:"[!:5]信用卡支付錯誤 錯誤代號0005",creditcard_user_terminate:"[!:5]信用卡支付錯誤 錯誤代號0006",ipass_info:"[:10]$var",ipass_failed:"[!:10]$var"};function s(e,t){let r="string"==typeof e&&e in d?e:e instanceof Object&&"arg"in e&&"mid"in e.arg?e.arg.mid:"",n=/^\[([^\]]+)\]/,i={time:-1,isAlert:!1,text:""};if(r in d){let t=d[r];if(n.test(t)){let e=t.match(n);i.text=t.replace(e[0],""),i.isAlert=!(!e[1].split(":")||"!"!==e[1].split(":")[0]),i.time=e[1].split(":")&&e[1].split(":")[1]?e[1].split(":")[1]:productboard_time}else if(/^(!)/.test(t)){let e=/^(!)/;i.text=t.replace(e,""),i.isAlert=!0,i.time=productboard_time}else i.text=t;/\$var/.test(i.text)&&e.arg&&e.arg.msg&&(i.text=i.text.replace("$var",e.arg.msg))}else{let n=c(e,t);if(""==n)return!1;i.text=n,/(error|fail|success)/.test(r)?(i.time=5,i.isAlert=/(error|fail)/.test(r)):/(失敗|錯誤|成功)/.test(n)&&(i.isAlert=/(失敗|錯誤)/.test(n),i.time=5)}return i.time="number"==typeof i.time?i.time:parseInt(i.time),i}
},{"webstomp-client":2,"push.js":3}]},{},[1])